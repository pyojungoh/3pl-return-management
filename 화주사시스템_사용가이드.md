# 🏢 화주사 반품 관리 시스템 사용 가이드

## 📋 시스템 개요

화주사가 자신의 반품 내역만 조회하고 요청사항을 남길 수 있는 시스템입니다.

---

## 🚀 초기 설정

### 1단계: Google Sheets 시트 구조 확인

#### **"화주사계정" 시트 생성**

스프레드시트에 새로운 시트를 만들고 이름을 **"화주사계정"**으로 변경하세요.

**시트 구조:**

| A: 화주명 | B: 로그인ID | C: 비밀번호 | D: 권한 | E: 연락처 |
|----------|-----------|----------|--------|---------|
| TKS      | tks       | 1234     | 화주사  | 010-xxx |
| 호이드    | hoyd      | 5678     | 화주사  | 010-yyy |
| 바이비드  | vyvyd     | 9012     | 화주사  | 010-zzz |
| 관리자    | admin     | admin123 | 관리자  | 010-aaa |

> ⚠️ **중요**: 1행은 헤더, 2행부터 계정 데이터를 입력하세요.

#### **반품 시트에 열 추가**

기존 반품 시트 (예: 2025년11월)에 다음 열을 추가하세요:

- **L열**: 화주사요청 (화주사가 요청사항 입력)
- **M열**: 화주사확인완료 (저장 시 자동 입력)

**최종 시트 구조 (A~M, 13개 열):**

```
A: 반품 접수일
B: 화주명
C: 제품
D: 고객명
E: 송장번호
F: 반품/교환/오배송
G: 재고상태(불량/정상)
H: 검품유무
I: 처리완료
J: 비고
K: 사진
L: 화주사요청          ← 새로 추가
M: 화주사확인완료       ← 새로 추가
```

---

### 2단계: Apps Script 파일 업로드

1. Google Sheets 열기
2. **확장 프로그램** > **Apps Script** 클릭
3. 기존 `Code.js` 내용을 모두 복사해서 백업
4. 새로운 `Code.js` 내용으로 교체
5. 새 파일 추가:
   - `login.html`
   - `dashboard.html`
6. **저장** 버튼 클릭

---

### 3단계: 웹앱 배포

1. Apps Script 편집기에서 **배포** > **새 배포** 클릭
2. **유형 선택**: 웹 앱
3. **설정**:
   - 실행 계정: **나**
   - 액세스 권한: **누구나** (또는 조직 내 사용자)
4. **배포** 클릭
5. **웹 앱 URL** 복사 (예: `https://script.google.com/macros/s/...`)

---

## 🔐 사용 방법

### 화주사 로그인

**URL 형식:**
```
https://script.google.com/macros/s/YOUR_SCRIPT_ID/exec?page=login
```

1. 위 URL로 접속
2. 아이디와 비밀번호 입력
3. **로그인** 버튼 클릭
4. 성공 시 자동으로 대시보드로 이동

> 💡 **자동 로그인**: 24시간 동안 로그인 상태 유지

---

### 화주사 대시보드

#### **기능 1: 반품 내역 조회**

- 월 선택 드롭다운에서 조회할 월 선택
- **자기 회사 데이터만** 표시됨
- 통계:
  - 전체 반품 건
  - 처리 완료
  - 처리 대기

#### **기능 2: 요청사항 입력**

1. 각 반품 건마다 "화주사 요청사항" 입력란이 있음
2. 요청사항 입력 (예: "정상 처리 부탁드립니다")
3. **저장** 버튼 클릭
4. 저장 후 **"화주사확인완료"** 표시
5. ⚠️ **한 번 저장하면 수정 불가**

#### **기능 3: 처리 상태 확인**

- **⏳ 대기중**: 관리자가 아직 처리하지 않음
- **✓ 담당자이름**: 관리자가 처리 완료

#### **기능 4: 사진 확인**

- 사진 링크 클릭 시 새 탭에서 열림
- 여러 장인 경우 모두 표시

---

### 관리자 페이지 (기존 유지)

**URL 형식:**
```
https://script.google.com/macros/s/YOUR_SCRIPT_ID/exec
```

- 기존대로 반품 등록 및 사진 업로드
- 변경사항 없음

---

## 📊 시트 업데이트 (관리자용)

### 처리 완료 표시 방법

화주사가 대시보드에서 "처리완료" 상태를 보려면:

**방법 1: I열(처리완료)에 담당자 이름 입력**
```
예: 강, 홍길동, 완료
```

**방법 2: 체크박스 사용 (추천)**
1. I열 선택
2. **삽입** > **체크박스**
3. 체크하면 TRUE로 표시됨
4. 화주사 화면에는 "✓ TRUE"로 표시

---

## 🔄 URL 정리

| 페이지 | URL |
|--------|-----|
| **화주사 로그인** | `?page=login` |
| **화주사 대시보드** | `?page=dashboard` |
| **관리자 페이지** | 기본 (파라미터 없음) |
| **API (JSON)** | `?api=1` |

---

## ⚙️ 트러블슈팅

### 문제 1: "화주사계정 시트가 없습니다"
- ✅ 해결: 시트 이름을 정확히 **"화주사계정"**으로 생성

### 문제 2: 로그인 후 데이터가 안 보임
- ✅ 해결: B열(화주명)과 "화주사계정" 시트의 A열(화주명)이 **정확히 일치**하는지 확인

### 문제 3: 요청사항 저장 실패
- ✅ 해결: L, M열이 추가되어 있는지 확인

### 문제 4: 24시간 후 자동 로그아웃
- ✅ 정상 동작: 보안을 위해 24시간마다 재로그인 필요

---

## 🎯 향후 추가 예정 기능

1. ✅ 공지사항 게시판
2. ✅ 월별 사용료 내역
3. ✅ 엑셀 다운로드
4. ✅ 검색 필터

---

## 📞 문의

시스템 관련 문의는 관리자에게 연락하세요.

---

## 🔒 보안 참고사항

- 비밀번호는 평문으로 저장됩니다 (간단한 시스템이므로)
- 더 강력한 보안이 필요하면 bcrypt 해시 방식으로 업그레이드 가능
- 24시간 자동 로그아웃으로 기본 보안 유지

---

**버전**: 1.0  
**최종 업데이트**: 2025년 11월



