# 스케쥴 알림 문제 진단 가이드

## 🔍 확인 사항

### 1. 등록 시 즉시 알림이 안 오는 경우

**확인할 것:**
- 스케쥴 등록이 성공했는지 확인
- Vercel 로그에서 에러 확인
- 환경 변수 설정 확인

**테스트 방법:**
1. 스케쥴을 새로 등록해보세요
2. Vercel 로그에서 다음 메시지 확인:
   - `[스케쥴 텔레그램] 알림 전송 함수 호출됨`
   - `스케쥴 텔레그램 알림 전송 성공` 또는 에러 메시지

### 2. 스케줄러 알림이 안 오는 경우

**확인할 것:**
- 현재 시간이 오전 9시인지 확인 (스케줄러는 오전 9시에만 실행)
- 스케쥴 날짜가 맞는지 확인
- 알림 플래그가 이미 설정되어 있는지 확인

**스케줄러 실행 조건:**
- 오전 9시 (KST)에만 실행
- 시작일 전 알림: 내일이 시작일
- 시작일 알림: 오늘이 시작일
- 종료일 알림: 오늘이 종료일 (시작일 != 종료일)

### 3. 환경 변수 확인

**필수 환경 변수:**
- `TELEGRAM_SCHEDULE_BOT_TOKEN`: 스케쥴 전용 봇 토큰
- `TELEGRAM_SCHEDULE_CHAT_ID`: 스케쥴 전용 채팅방 ID

**확인 방법:**
- Vercel 대시보드 → Settings → Environment Variables
- 두 환경 변수가 모두 설정되어 있는지 확인

### 4. 테스트 엔드포인트

**테스트 API 호출:**
```
POST https://your-domain.vercel.app/api/schedule-notifications/test
```

이 엔드포인트로 텔레그램 메시지가 오는지 확인하세요.

## 🛠️ 문제 해결 단계

1. **테스트 엔드포인트로 확인**
   - 테스트 API 호출해서 메시지가 오는지 확인
   - 안 오면 환경 변수 문제

2. **스케쥴 등록 시 확인**
   - 새 스케쥴 등록
   - Vercel 로그 확인
   - 즉시 알림이 와야 함

3. **스케줄러 확인**
   - 오전 9시에 실행되는지 확인
   - Vercel 로그에서 스케줄러 실행 로그 확인

4. **데이터베이스 확인**
   - 알림 플래그가 이미 설정되어 있으면 알림이 안 옴
   - 스케쥴 날짜가 맞는지 확인


