# 배포 환경 최종 테스트 가이드

## ✅ 완료된 단계

- [x] 테스트 사용자 추가 완료
- [x] 로컬에서 인증 성공
- [x] token.pickle 파일 생성 확인
- [x] 토큰 추출 완료
- [x] Vercel 환경 변수 설정 완료

## 🚀 배포 환경 테스트

### 1단계: 배포 확인

1. **Vercel 대시보드 확인**
   - https://vercel.com/
   - 프로젝트 선택
   - **Deployments** 탭 확인
   - 최신 배포가 "Ready" 상태인지 확인

2. **환경 변수 확인**
   - **Settings** → **Environment Variables**
   - 다음 두 개가 모두 있는지 확인:
     - ✅ `GOOGLE_OAUTH_CREDENTIALS_JSON`
     - ✅ `GOOGLE_OAUTH_TOKEN_JSON`
   - 각각의 Environment가 모두 선택되어 있는지 확인:
     - ✅ Production
     - ✅ Preview
     - ✅ Development

### 2단계: 재배포 (환경 변수 추가 후)

환경 변수를 추가한 후에는 **재배포가 필요**합니다:

1. **Deployments 탭으로 이동**
2. **최신 배포 항목 찾기**
3. **오른쪽 "..." 메뉴 클릭**
4. **"Redeploy" 선택**
5. **배포 완료 대기** (보통 1-2분)

또는:
- 코드를 약간 수정하고 `git push`하여 자동 재배포

### 3단계: 배포 환경에서 테스트

1. **테스트 페이지 접속**
   ```
   https://jjaysolution.com/test-excel-upload.html
   ```
   또는
   ```
   https://3pl-return-management.vercel.app/test-excel-upload.html
   ```

2. **엑셀 파일 업로드 테스트**
   - 엑셀 파일 선택 (또는 드래그 앤 드롭)
   - "업로드 시작" 버튼 클릭
   - 결과 확인

3. **성공 확인**
   - ✅ 파일 링크가 표시되면 성공!
   - ✅ Google Drive에 파일이 업로드되었는지 확인

## 🔍 문제 해결

### 오류가 발생하는 경우

#### 1. "인증 정보를 찾을 수 없습니다" 오류

**원인**: 환경 변수가 로드되지 않음

**해결**:
- Vercel 환경 변수 확인
- 재배포 확인
- Vercel 로그 확인 (Deployments → Functions → Logs)

#### 2. "토큰이 만료되었습니다" 오류

**원인**: 토큰이 만료됨

**해결**:
- 로컬에서 다시 인증 받기
- `python extract_oauth_token.py` 실행
- Vercel 환경 변수 `GOOGLE_OAUTH_TOKEN_JSON` 업데이트
- 재배포

#### 3. "폴더를 찾을 수 없습니다" 오류

**원인**: Google Drive 폴더 구조 문제

**해결**:
- Google Drive에서 `제이제이솔루션` 폴더 확인
- `정산파일` 폴더가 있는지 확인
- 폴더가 올바른 위치에 있는지 확인

## 📋 체크리스트

배포 환경 테스트:
- [ ] Vercel 배포 상태 확인 (Ready)
- [ ] 환경 변수 확인 (두 개 모두 설정됨)
- [ ] 재배포 완료 (환경 변수 추가 후)
- [ ] 배포 환경에서 테스트 페이지 접속
- [ ] 엑셀 파일 업로드 테스트
- [ ] 성공 확인 (파일 링크 표시)

## 🎉 성공 시

배포 환경에서 엑셀 파일 업로드가 성공하면:
1. ✅ Google Drive 연동 완료
2. ✅ OAuth 2.0 설정 완료
3. ✅ 배포 환경에서 정상 작동 확인

## 📝 다음 단계

성공 후:
1. 실제 사용자에게 배포
2. 모니터링 및 로그 확인
3. 토큰 만료 시 재인증 프로세스 준비

