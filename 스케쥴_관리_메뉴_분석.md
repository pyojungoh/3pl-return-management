# ìŠ¤ì¼€ì¥´ ê´€ë¦¬ ë©”ë‰´ ì „ì²´ êµ¬ì¡° ë¶„ì„

## ğŸ“ íŒŒì¼ êµ¬ì¡°

### 1. í”„ë¡ íŠ¸ì—”ë“œ (dashboard_server.html)
- **í™”ì£¼ì‚¬ ëª¨ë“œ**: `scheduleTab` (ID: `scheduleTab`)
- **ê´€ë¦¬ì ëª¨ë“œ**: `scheduleCalendarTab` (ID: `scheduleCalendarTab`)

### 2. ë°±ì—”ë“œ API (api/schedules/routes_db.py)
- Blueprint: `schedules_bp` (URL prefix: `/api/schedules`)

### 3. ë°ì´í„°ë² ì´ìŠ¤ ëª¨ë¸ (api/database/models.py)
- í…Œì´ë¸”: `schedules`, `schedule_types`
- í•¨ìˆ˜ë“¤: `create_schedule`, `get_schedules_by_company`, `get_all_schedules`, `get_schedules_by_date_range`, `get_schedule_by_id`, `update_schedule`, `delete_schedule`, `create_schedule_type`, `get_all_schedule_types`, `delete_schedule_type`

---

## ğŸ—„ï¸ ë°ì´í„°ë² ì´ìŠ¤ êµ¬ì¡°

### schedules í…Œì´ë¸”
```sql
CREATE TABLE schedules (
    id SERIAL PRIMARY KEY,
    company_name TEXT NOT NULL,
    title TEXT NOT NULL,
    start_date DATE NOT NULL,
    end_date DATE NOT NULL,
    event_description TEXT,
    request_note TEXT,
    schedule_type TEXT,  -- ì¶”ê°€ëœ ì»¬ëŸ¼
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
)
```

### schedule_types í…Œì´ë¸”
```sql
CREATE TABLE schedule_types (
    id SERIAL PRIMARY KEY,
    name TEXT NOT NULL UNIQUE,
    display_order INTEGER DEFAULT 0,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
)
```

---

## ğŸ”Œ API ì—”ë“œí¬ì¸íŠ¸

### 1. ìŠ¤ì¼€ì¥´ ëª©ë¡ ì¡°íšŒ
- **URL**: `GET /api/schedules/list`
- **Query Parameters**:
  - `company`: í™”ì£¼ì‚¬ëª… (í™”ì£¼ì‚¬ ëª¨ë“œì¼ ë•Œ í•„ìˆ˜)
  - `role`: ê¶Œí•œ ("ê´€ë¦¬ì" ë˜ëŠ” "í™”ì£¼ì‚¬")
- **ì‘ë‹µ**: `{ success, data, count, message }`

### 2. ë‹¬ë ¥ìš© ìŠ¤ì¼€ì¥´ ì¡°íšŒ (ê´€ë¦¬ììš©)
- **URL**: `GET /api/schedules/calendar`
- **Query Parameters**:
  - `startDate`: ì‹œì‘ ë‚ ì§œ (YYYY-MM-DD)
  - `endDate`: ì¢…ë£Œ ë‚ ì§œ (YYYY-MM-DD)
  - `month`: ì›” (ì˜ˆ: "2025-11") - ì„ íƒì‚¬í•­
- **ì‘ë‹µ**: `{ success, data, count, startDate, endDate, message }`

### 3. ìŠ¤ì¼€ì¥´ ìƒì„±
- **URL**: `POST /api/schedules/create`
- **Request Body**:
  ```json
  {
    "company_name": "string",
    "schedule_type": "string",
    "title": "string",
    "start_date": "YYYY-MM-DD",
    "end_date": "YYYY-MM-DD",
    "event_description": "string",
    "request_note": "string" (ì„ íƒì‚¬í•­)
  }
  ```
- **íŠ¹ì§•**: "ëª¨ë“  í™”ì£¼ì‚¬" ì„ íƒ ì‹œ ëª¨ë“  í™”ì£¼ì‚¬ì—ê²Œ ìŠ¤ì¼€ì¤„ ìƒì„±

### 4. ìŠ¤ì¼€ì¥´ ìˆ˜ì •
- **URL**: `PUT /api/schedules/update/<schedule_id>`
- **Request Body**: ìˆ˜ì •í•  í•„ë“œë§Œ ì „ë‹¬

### 5. ìŠ¤ì¼€ì¥´ ì‚­ì œ
- **URL**: `DELETE /api/schedules/delete/<schedule_id>`
- **Query Parameters**:
  - `role`: ê¶Œí•œ
  - `company`: í™”ì£¼ì‚¬ëª… (í™”ì£¼ì‚¬ ëª¨ë“œì¼ ë•Œ)

### 6. ìŠ¤ì¼€ì¥´ ìƒì„¸ ì¡°íšŒ
- **URL**: `GET /api/schedules/<schedule_id>`

### 7. ìŠ¤ì¼€ì¤„ íƒ€ì… ê´€ë¦¬
- **GET /api/schedules/types**: íƒ€ì… ëª©ë¡ ì¡°íšŒ
- **POST /api/schedules/types**: íƒ€ì… ìƒì„±
- **DELETE /api/schedules/types/<type_id>`: íƒ€ì… ì‚­ì œ

---

## ğŸ¨ í”„ë¡ íŠ¸ì—”ë“œ êµ¬ì¡°

### í™”ì£¼ì‚¬ ëª¨ë“œ (scheduleTab)

#### HTML êµ¬ì¡°
```html
<div id="scheduleTab" class="tab-content hidden">
  <!-- ìŠ¤ì¼€ì¥´ ë“±ë¡ ì ‘ì´ì‹ ë²„íŠ¼ -->
  <button id="addScheduleBtn" onclick="toggleScheduleForm()">â• ìŠ¤ì¼€ì¥´ ë“±ë¡</button>
  
  <!-- ìŠ¤ì¼€ì¥´ ë“±ë¡ í¼ (ì ‘ì´ì‹) -->
  <div id="scheduleForm" style="display: none;">
    - ìŠ¤ì¼€ì¤„ íƒ€ì… ì„ íƒ (scheduleType)
    - ì œëª© (scheduleTitle)
    - ì‹œì‘ì¼ (scheduleStartDate)
    - ì¢…ë£Œì¼ (scheduleEndDate)
    - í–‰ì‚¬ ë‚´ìš© (scheduleEventDescription)
    - ìš”ì²­ì‚¬í•­ (scheduleRequestNote)
  </div>
  
  <!-- ìŠ¤ì¼€ì¥´ ëª©ë¡ í…Œì´ë¸” -->
  <table>
    <tbody id="scheduleTableBody">
      <!-- ë™ì ìœ¼ë¡œ ìƒì„± -->
    </tbody>
  </table>
</div>
```

#### JavaScript í•¨ìˆ˜ë“¤
1. **toggleScheduleForm()**: ë“±ë¡ í¼ ì ‘ê¸°/í¼ì¹˜ê¸°
2. **loadScheduleTypesForConsignor()**: í™”ì£¼ì‚¬ìš© ìŠ¤ì¼€ì¤„ íƒ€ì… ëª©ë¡ ë¡œë“œ
3. **saveSchedule()**: ìŠ¤ì¼€ì¥´ ì €ì¥
4. **resetScheduleForm()**: í¼ ì´ˆê¸°í™”
5. **refreshSchedules()**: ìŠ¤ì¼€ì¥´ ëª©ë¡ ìƒˆë¡œê³ ì¹¨
6. **editSchedule(scheduleId)**: ìŠ¤ì¼€ì¥´ ìˆ˜ì • ëª¨ë“œë¡œ ì „í™˜
7. **updateSchedule(scheduleId)**: ìŠ¤ì¼€ì¥´ ì—…ë°ì´íŠ¸
8. **deleteSchedule(scheduleId)**: ìŠ¤ì¼€ì¥´ ì‚­ì œ

#### ë©”ë‰´ ì „í™˜ ì‹œ ë™ì‘
```javascript
// switchMenu('schedule') í˜¸ì¶œ ì‹œ
- scheduleTab í‘œì‹œ
- refreshSchedules() í˜¸ì¶œ
- loadScheduleTypesForConsignor() í˜¸ì¶œ
```

---

### ê´€ë¦¬ì ëª¨ë“œ (scheduleCalendarTab)

#### HTML êµ¬ì¡°
```html
<div id="scheduleCalendarTab" class="tab-content hidden">
  <!-- ìŠ¤ì¼€ì¥´ ë“±ë¡ ì ‘ì´ì‹ ë²„íŠ¼ (ê´€ë¦¬ììš©) -->
  <button id="addAdminScheduleBtn" onclick="toggleAdminScheduleForm()">â• ìŠ¤ì¼€ì¥´ ë“±ë¡ (ê´€ë¦¬ì)</button>
  
  <!-- ìŠ¤ì¼€ì¥´ ë“±ë¡ í¼ (ì ‘ì´ì‹) -->
  <div id="addAdminScheduleForm" style="display: none;">
    - í™”ì£¼ì‚¬ ì„ íƒ (ê²€ìƒ‰ ê°€ëŠ¥í•œ ë“œë¡­ë‹¤ìš´)
    - ìŠ¤ì¼€ì¤„ íƒ€ì… ì„ íƒ + íƒ€ì… ê´€ë¦¬ ë²„íŠ¼
    - ì œëª©, ì‹œì‘ì¼, ì¢…ë£Œì¼, í–‰ì‚¬ ë‚´ìš©, ìš”ì²­ì‚¬í•­
  </div>
  
  <!-- ë‹¬ë ¥ ë° ëª©ë¡ -->
  <div>
    <input type="month" id="calendarMonthSelect" onchange="loadCalendarSchedules()">
    <div id="calendarContainer"><!-- ë‹¬ë ¥ ë™ì  ìƒì„± --></div>
  </div>
  
  <!-- ìŠ¤ì¼€ì¥´ ëª©ë¡ í…Œì´ë¸” -->
  <table>
    <tbody id="scheduleListTableBody"><!-- ë™ì ìœ¼ë¡œ ìƒì„± --></tbody>
  </table>
</div>
```

#### JavaScript í•¨ìˆ˜ë“¤
1. **toggleAdminScheduleForm()**: ê´€ë¦¬ì ë“±ë¡ í¼ ì ‘ê¸°/í¼ì¹˜ê¸°
2. **loadCompaniesForSchedule()**: í™”ì£¼ì‚¬ ëª©ë¡ ë¡œë“œ (ê²€ìƒ‰ ê°€ëŠ¥í•œ ë“œë¡­ë‹¤ìš´)
3. **loadScheduleTypes()**: ìŠ¤ì¼€ì¤„ íƒ€ì… ëª©ë¡ ë¡œë“œ
4. **toggleScheduleTypeManager()**: íƒ€ì… ê´€ë¦¬ì í† ê¸€
5. **addCustomScheduleType()**: ì»¤ìŠ¤í…€ íƒ€ì… ì¶”ê°€
6. **saveAdminSchedule()**: ê´€ë¦¬ì ìŠ¤ì¼€ì¥´ ì €ì¥
7. **resetAdminScheduleForm()**: ê´€ë¦¬ì í¼ ì´ˆê¸°í™”
8. **loadCalendarSchedules()**: ë‹¬ë ¥ ë° ëª©ë¡ ë¡œë“œ (âš ï¸ í•¨ìˆ˜ ì •ì˜ ìœ„ì¹˜ í™•ì¸ í•„ìš”)

#### ë©”ë‰´ ì „í™˜ ì‹œ ë™ì‘
```javascript
// switchAdminTab('scheduleCalendar') í˜¸ì¶œ ì‹œ
- scheduleCalendarTab í‘œì‹œ
- loadCalendarSchedules() í˜¸ì¶œ
- loadScheduleTypes() í˜¸ì¶œ
```

---

## ğŸ”„ ë°ì´í„° íë¦„

### í™”ì£¼ì‚¬ ëª¨ë“œ - ìŠ¤ì¼€ì¥´ ë“±ë¡
1. ì‚¬ìš©ìê°€ ë“±ë¡ í¼ ì‘ì„±
2. `saveSchedule()` í˜¸ì¶œ
3. `POST /api/schedules/create` ìš”ì²­
4. ì„œë²„ì—ì„œ `create_schedule()` í˜¸ì¶œ
5. ì„±ê³µ ì‹œ `refreshSchedules()` í˜¸ì¶œí•˜ì—¬ ëª©ë¡ ê°±ì‹ 

### í™”ì£¼ì‚¬ ëª¨ë“œ - ìŠ¤ì¼€ì¥´ ì¡°íšŒ
1. `refreshSchedules()` í˜¸ì¶œ
2. `GET /api/schedules/list?company={currentCompany}&role=í™”ì£¼ì‚¬` ìš”ì²­
3. ì„œë²„ì—ì„œ `get_schedules_by_company()` í˜¸ì¶œ
4. í…Œì´ë¸”ì— ë™ì ìœ¼ë¡œ ë Œë”ë§

### ê´€ë¦¬ì ëª¨ë“œ - ë‹¬ë ¥ ì¡°íšŒ
1. `loadCalendarSchedules()` í˜¸ì¶œ (í•¨ìˆ˜ ì •ì˜ ìœ„ì¹˜ í™•ì¸ í•„ìš”)
2. `GET /api/schedules/calendar?month={selectedMonth}` ìš”ì²­
3. ì„œë²„ì—ì„œ `get_schedules_by_date_range()` í˜¸ì¶œ
4. ë‹¬ë ¥ ë° ëª©ë¡ í…Œì´ë¸”ì— ë Œë”ë§

---

## ğŸ“‹ ì£¼ìš” JavaScript í•¨ìˆ˜ ìƒì„¸

### loadCalendarSchedules() í•¨ìˆ˜ (ë¼ì¸ 6213)
```javascript
async function loadCalendarSchedules() {
  // 1. calendarContainerì™€ scheduleListTableBody ì´ˆê¸°í™”
  // 2. calendarMonthSelectì—ì„œ ì„ íƒëœ ì›” ê°€ì ¸ì˜¤ê¸°
  // 3. GET /api/schedules/calendar?month={month} ìš”ì²­
  // 4. ì„±ê³µ ì‹œ renderCalendar()ì™€ renderScheduleListTable() í˜¸ì¶œ
}
```

### renderCalendar() í•¨ìˆ˜ (ë¼ì¸ 6289)
- ë‹¬ë ¥ì„ ë™ì ìœ¼ë¡œ ìƒì„± (ì™¸ë¶€ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì—†ì´ ìˆœìˆ˜ JavaScript)
- ë‚ ì§œë³„ë¡œ ìŠ¤ì¼€ì¥´ ê·¸ë£¹í™”
- "ëª¨ë“ í™”ì£¼ì‚¬" ìŠ¤ì¼€ì¤„ ì¤‘ë³µ ì œê±° ë¡œì§ í¬í•¨
- í™”ì£¼ì‚¬ë³„ ìƒ‰ìƒ í• ë‹¹ (getCompanyColor í•¨ìˆ˜ ì‚¬ìš©)
- ê° ë‚ ì§œ í´ë¦­ ì‹œ ëª¨ë‹¬ í‘œì‹œ (showScheduleModal)

### renderScheduleListTable() í•¨ìˆ˜
- ìŠ¤ì¼€ì¥´ ëª©ë¡ì„ í…Œì´ë¸”ë¡œ ë Œë”ë§
- í†µê³„ ì •ë³´ ì—…ë°ì´íŠ¸ (schedulesStatistics)

### getCompanyColor() í•¨ìˆ˜ (ë¼ì¸ 6256)
- í™”ì£¼ì‚¬ëª…ì„ ê¸°ë°˜ìœ¼ë¡œ ì¼ê´€ëœ ìƒ‰ìƒ í• ë‹¹
- í•´ì‹œ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ë™ì¼í•œ í™”ì£¼ì‚¬ëŠ” í•­ìƒ ê°™ì€ ìƒ‰ìƒ
- 15ê°€ì§€ ê·¸ë¼ë°ì´ì…˜ ìƒ‰ìƒ íŒ”ë ˆíŠ¸ ì œê³µ

### ë‹¬ë ¥ ë Œë”ë§ íŠ¹ì§•
- ìˆœìˆ˜ JavaScriptë¡œ êµ¬í˜„ (ì™¸ë¶€ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì—†ìŒ)
- ê·¸ë¦¬ë“œ ë ˆì´ì•„ì›ƒ ì‚¬ìš© (7ì—´: ì¼~í† )
- ë‚ ì§œë³„ ìŠ¤ì¼€ì¥´ ìµœëŒ€ 3ê°œ í‘œì‹œ, ë‚˜ë¨¸ì§€ëŠ” "+N" í˜•ì‹
- ì˜¤ëŠ˜ ë‚ ì§œ ê°•ì¡° í‘œì‹œ
- ê° ë‚ ì§œ í´ë¦­ ì‹œ í•´ë‹¹ ë‚ ì§œì˜ ìŠ¤ì¼€ì¥´ ëª¨ë‹¬ í‘œì‹œ

---

## ğŸ“ ì£¼ìš” íŠ¹ì§•

1. **ëª¨ë“œ ë¶„ë¦¬**
   - í™”ì£¼ì‚¬ ëª¨ë“œ: ìì‹ ì˜ ìŠ¤ì¼€ì¥´ë§Œ ì¡°íšŒ/ê´€ë¦¬
   - ê´€ë¦¬ì ëª¨ë“œ: ì „ì²´ í™”ì£¼ì‚¬ ìŠ¤ì¼€ì¥´ ì¡°íšŒ/ê´€ë¦¬ + ë‹¬ë ¥ ë·°

2. **"ëª¨ë“  í™”ì£¼ì‚¬" ê¸°ëŠ¥**
   - ê´€ë¦¬ìê°€ "ëª¨ë“  í™”ì£¼ì‚¬" ì„ íƒ ì‹œ ëª¨ë“  í™”ì£¼ì‚¬ì—ê²Œ ë™ì¼í•œ ìŠ¤ì¼€ì¤„ ìƒì„±
   - ê° í™”ì£¼ì‚¬ì˜ ì‹¤ì œ `company_name`ìœ¼ë¡œ ì €ì¥
   - `schedule_type`ì— "ëª¨ë“ í™”ì£¼ì‚¬-" ì ‘ë‘ì‚¬ ì¶”ê°€

3. **ìŠ¤ì¼€ì¤„ íƒ€ì… ì‹œìŠ¤í…œ**
   - ê¸°ë³¸ íƒ€ì…: ì…ê³ , ì¶œê³ , í–‰ì‚¬, ì—°íœ´, ê¸°íƒ€
   - ê´€ë¦¬ìê°€ ì»¤ìŠ¤í…€ íƒ€ì… ì¶”ê°€ ê°€ëŠ¥
   - `display_order`ë¡œ ì •ë ¬ ìˆœì„œ ì œì–´

4. **ê¶Œí•œ ê¸°ë°˜ ì ‘ê·¼ ì œì–´**
   - í™”ì£¼ì‚¬ëŠ” ìì‹ ì˜ ìŠ¤ì¼€ì¥´ë§Œ ì‚­ì œ ê°€ëŠ¥
   - ê´€ë¦¬ìëŠ” ëª¨ë“  ìŠ¤ì¼€ì¥´ ì‚­ì œ ê°€ëŠ¥
   - API ë ˆë²¨ì—ì„œ ê¶Œí•œ ê²€ì¦ ìˆ˜í–‰

---

## ğŸ” ë‹¤ìŒ ë‹¨ê³„

1. `loadCalendarSchedules()` í•¨ìˆ˜ ì •ì˜ ìœ„ì¹˜ í™•ì¸
2. ë‹¬ë ¥ ë Œë”ë§ ë¡œì§ í™•ì¸
3. ì‚¬ìš©ì ìš”êµ¬ì‚¬í•­ì— ë”°ë¥¸ ìˆ˜ì • ì‚¬í•­ íŒŒì•…

