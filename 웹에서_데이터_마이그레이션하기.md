# 🌐 웹에서 데이터 마이그레이션하기

CSV 파일에서 PostgreSQL로 데이터를 마이그레이션하는 방법입니다.

## 🚀 방법 1: 브라우저 콘솔에서 실행 (가장 간단)

1. **웹사이트 접속**
   - Vercel 배포 URL로 접속
   - 관리자 계정으로 로그인 (admin/admin123)

2. **개발자 도구 열기**
   - F12 키 누르기
   - 또는 우클릭 → "검사" 선택

3. **콘솔 탭 선택**

4. **아래 코드 복사하여 붙여넣고 Enter**

```javascript
// 데이터 마이그레이션 실행
fetch('/api/admin/migrate-from-csv', {
    method: 'POST',
    headers: {
        'Content-Type': 'application/json'
    },
    body: JSON.stringify({ force: false })
})
.then(response => response.json())
.then(data => {
    console.log('✅ 마이그레이션 결과:', data);
    if (data.success) {
        alert(`마이그레이션 완료!\n\n화주사 계정: ${data.results.companies.success}개 성공\n반품 데이터: ${data.results.returns.success}개 성공\n\n페이지를 새로고침하세요.`);
        location.reload();
    } else {
        alert('마이그레이션 실패: ' + data.message);
    }
})
.catch(error => {
    console.error('❌ 오류:', error);
    alert('마이그레이션 중 오류 발생: ' + error.message);
});
```

5. **결과 확인**
   - 마이그레이션 완료 메시지 확인
   - 페이지 자동 새로고침
   - 데이터가 표시되는지 확인

## 🚀 방법 2: 마이그레이션 상태 확인

```javascript
// 마이그레이션 상태 확인
fetch('/api/admin/migrate-status')
.then(response => response.json())
.then(data => {
    console.log('📊 데이터베이스 통계:', data);
    if (data.success) {
        console.log('화주사 계정:', data.statistics.companies);
        console.log('반품 데이터:', data.statistics.returns);
    }
})
.catch(error => {
    console.error('❌ 오류:', error);
});
```

## ⚠️ 주의사항

1. **CSV 파일 필요**
   - `csv_data/companies.csv` - 화주사 계정
   - `csv_data/YYYY년MM월.csv` - 반품 데이터
   - CSV 파일들이 GitHub에 포함되어 있어야 합니다

2. **중복 데이터**
   - 기본적으로 기존 데이터는 건너뜀니다
   - `force: true`로 설정하면 기존 데이터도 업데이트합니다

3. **마이그레이션 시간**
   - 데이터가 많으면 시간이 걸릴 수 있습니다
   - 콘솔에서 진행 상황을 확인하세요

## 🔍 문제 해결

### CSV 파일을 찾을 수 없음
- GitHub에 `csv_data` 폴더와 CSV 파일들이 포함되어 있는지 확인
- Vercel 배포 후 파일들이 업로드되었는지 확인

### 마이그레이션 실패
- 브라우저 콘솔에서 오류 메시지 확인
- Vercel 배포 로그 확인
- PostgreSQL 연결 상태 확인

### 데이터가 표시되지 않음
- 페이지 새로고침 (F5)
- 월 선택 드롭다운에서 다른 월 선택
- 브라우저 캐시 삭제

## ✅ 완료 후

1. **데이터 확인**
   - 대시보드에서 화주사 계정 목록 확인
   - 반품 데이터 목록 확인
   - 통계 정보 확인

2. **문제가 있으면**
   - 마이그레이션 상태 확인 API 실행
   - 브라우저 콘솔 오류 확인
   - Vercel 배포 로그 확인

